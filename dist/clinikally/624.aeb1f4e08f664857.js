"use strict";(self.webpackChunkclinikally=self.webpackChunkclinikally||[]).push([[624],{2624:(U,g,s)=>{s.r(g),s.d(g,{ProfileSettingsModule:()=>O});var u=s(177),c=s(1188),a=s(9417),v=s(8615),F=s(5312),e=s(4438),y=s(2239),_=s(5794),b=s(9733),h=s(4478);function k(n,p){if(1&n&&e.nrm(0,"img",52),2&n){const t=e.XpG();e.Y8G("src",t.selectedImageUrl,e.B4B)}}function C(n,p){1&n&&e.nrm(0,"i",53)}function N(n,p){1&n&&(e.j41(0,"div",20),e.EFF(1," First Name is required. "),e.k0s())}function j(n,p){1&n&&(e.j41(0,"div",20),e.EFF(1," Last Name is required. "),e.k0s())}function I(n,p){1&n&&(e.j41(0,"div",20),e.EFF(1," Phone Number is required. "),e.k0s())}function S(n,p){1&n&&(e.j41(0,"div"),e.EFF(1,"Email is required."),e.k0s())}function P(n,p){1&n&&(e.j41(0,"div"),e.EFF(1,"Invalid email format."),e.k0s())}function E(n,p){if(1&n&&(e.j41(0,"div",20),e.DNE(1,S,2,0,"div",54)(2,P,2,0,"div",54),e.k0s()),2&n){let t,l;const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==(t=i.profileForm.get("email"))||null==t.errors?null:t.errors.required),e.R7$(),e.Y8G("ngIf",null==(l=i.profileForm.get("email"))||null==l.errors?null:l.errors.email)}}function D(n,p){if(1&n&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&n){const t=p.$implicit;e.Y8G("value",t),e.R7$(),e.JRh(t)}}function G(n,p){1&n&&(e.j41(0,"div",20),e.EFF(1," age is required. "),e.k0s())}const T=[{path:"",component:(()=>{class n{constructor(t,l,i){this.fb=t,this.patientsService=l,this.toastr=i,this.routes=v.J,this.date=new Date,this.baseUrl=F.c.ImgBaseUrl,this.bloodGroups=["A+","A-","B+","B-","AB+","AB-","O+","O-"],this.selectedImageUrl=null,this.maxDate=new Date,this.Detail=localStorage.getItem("UserDetail"),this.Detail=JSON.parse(this.Detail),this.profileForm=this.fb.group({profileImage:[null],firstName:["",a.k0.required],lastName:["",a.k0.required],dateOfBirth:[null],phoneNumber:["",a.k0.required],email:["",[a.k0.required,a.k0.email]],bloodGroup:[""],address:[""],city:[""],state:[""],country:[""],pincode:[""],age:[""]})}ngOnInit(){this.myDateValue=new Date,this.profileForm.get("dateOfBirth")?.setValue(null),this.getUserInfo()}onSubmit(){if(this.profileForm.valid){const t=new FormData;t.append("Image",this.profileForm.get("profileImage")?.value),t.append("PatientId",this.Detail?.nameid),t.append("Name",this.profileForm.get("firstName")?.value+" "+this.profileForm.get("lastName")?.value),t.append("FirstName",this.profileForm.get("firstName")?.value),t.append("LastName",this.profileForm.get("lastName")?.value),t.append("DateOfBirth",this.dateOfBirth),t.append("PhoneNumber",this.profileForm.get("phoneNumber")?.value),t.append("Email",this.profileForm.get("email")?.value),t.append("BloodGroup",this.profileForm.get("bloodGroup")?.value),t.append("Address",this.profileForm.get("address")?.value),t.append("City",this.profileForm.get("city")?.value),t.append("State",this.profileForm.get("state")?.value),t.append("Country",this.profileForm.get("country")?.value),t.append("PinCode",this.profileForm.get("pincode")?.value),t.append("age",this.profileForm.get("age")?.value),this.patientsService.updatePatientinfo(t).subscribe(l=>{l.isSuccess?(this.patientsService.userSubject.next(l),this.toastr.success(l.message)):this.toastr.error("Failed to update patient details.")})}}onFileChange(t){if(t.target.files.length>0){const l=t.target.files[0];if(["image/jpeg","image/png","image/jpg"].includes(l.type)){const o=new FileReader;o.onload=()=>{this.selectedImageUrl=o.result},o.readAsDataURL(l),this.profileForm.patchValue({profileImage:l})}else this.toastr.error("Please upload a valid image file (jpg, jpeg, png).")}else this.profileForm.patchValue({profileImage:null})}getUserInfo(){this.patientsService.getPatientinfo().subscribe(t=>{t.data&&(t.data.dateOfBirth&&this.profileForm.patchValue({dateOfBirth:t.data.dateOfBirth}),this.profileForm.patchValue({profileImage:t.data.profileImage,firstName:t.data.firstName,lastName:t.data.lastName,phoneNumber:t.data.phoneNumber,email:t.data.email,bloodGroup:t.data.bloodGroup,address:t.data.address,city:t.data.city,state:t.data.state,country:t.data.country,pincode:t.data.pinCode,age:t.data.age}),this.selectedImageUrl=this.generateImageUrl(t.data.image))})}generateImageUrl(t){return`${this.baseUrl}${t}`}onDateChange(t){const l=new Date(t);if(isNaN(l.getTime()))return;const i=this.formatDate(l);this.dateOfBirth=i}formatDate(t){return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}-${t.getDate().toString().padStart(2,"0")}`}removeFile(){this.selectedImageUrl="",this.profileForm.get("profileImage")?.setValue(null),this.patientsService.userSubject.next("")}validateNumber(t){const l=String.fromCharCode(t.keyCode);/^[0-9]*$/.test(l)||t.preventDefault()}checkLength(t){const l=t.target;l.value.length>6&&(l.value=l.value.slice(0,6))}preventWhitespace(t){" "===t.key&&t.preventDefault()}static#e=this.\u0275fac=function(l){return new(l||n)(e.rXU(a.ok),e.rXU(y.K),e.rXU(_.tw))};static#t=this.\u0275cmp=e.VBU({type:n,selectors:[["app-profile-settings"]],decls:113,vars:11,consts:[[1,"content","profile-set"],[1,"container"],[1,"row"],[1,"col-lg-4","col-xl-3"],[1,"col-lg-8","col-xl-9"],[3,"ngSubmit","formGroup"],[1,"setting-card"],[1,"change-avatar","img-upload"],[1,"profile-img"],["loading","lazy","alt","",3,"src",4,"ngIf"],["class","fa-solid fa-file-image",4,"ngIf"],[1,"upload-img"],[1,"imgs-load","d-flex","align-items-center"],[1,"change-photo"],["type","file","accept",".jpg,.jpeg,.png,.svg",1,"upload",3,"change"],[1,"form-text"],[1,"setting-title"],[1,"col-lg-4","col-md-6"],[1,"form-wrap"],["for","firstName",1,"col-form-label"],[1,"text-danger"],["type","text","formControlName","firstName",1,"form-control",3,"keypress"],["class","text-danger",4,"ngIf"],["for","lastName",1,"col-form-label"],["type","text","formControlName","lastName",1,"form-control",3,"keypress"],["for","dateOfBirth",1,"col-form-label"],["formControlName","dateOfBirth","dateFormat","yy-mm-dd",1,"calendar-p",3,"ngModelChange","onInput","maxDate"],[1,"col-lg-6","col-md-6"],["for","phoneNumber",1,"col-form-label"],["type","text","formControlName","phoneNumber",1,"form-control",3,"keypress"],["for","email",1,"col-form-label"],["type","email","formControlName","email",1,"form-control",3,"keypress"],["for","bloodGroup",1,"col-form-label"],["formControlName","bloodGroup",1,"form-control"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],["for","age",1,"col-form-label"],["type","text","formControlName","age",1,"form-control",3,"keypress"],[1,"col-lg-12"],["for","address",1,"col-form-label"],["type","text","formControlName","address",1,"form-control",3,"keypress"],[1,"col-md-6"],["for","city",1,"col-form-label"],["type","text","formControlName","city",1,"form-control",3,"keypress"],["for","state",1,"col-form-label"],["type","text","formControlName","state",1,"form-control",3,"keypress"],["for","country",1,"col-form-label"],["type","text","formControlName","country",1,"form-control",3,"keypress"],["for","pincode",1,"col-form-label"],["type","text","formControlName","pincode",1,"form-control",3,"keypress","input"],[1,"modal-btn","text-end"],["type","submit",1,"btn","btn-primary","prime-btn",3,"disabled"],["loading","lazy","alt","",3,"src"],[1,"fa-solid","fa-file-image"],[4,"ngIf"],[3,"value"]],template:function(l,i){if(1&l&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2),e.nrm(3,"app-patient-sidebar",3),e.j41(4,"div",4)(5,"form",5),e.bIt("ngSubmit",function(){return i.onSubmit()}),e.j41(6,"div",6)(7,"div",7)(8,"div",8),e.DNE(9,k,1,1,"img",9)(10,C,1,0,"i",10),e.k0s(),e.j41(11,"div",11)(12,"h5"),e.EFF(13,"Profile Image"),e.k0s(),e.j41(14,"div",12)(15,"div",13),e.EFF(16," Upload New "),e.j41(17,"input",14),e.bIt("change",function(o){return i.onFileChange(o)}),e.k0s()()(),e.j41(18,"p",15),e.EFF(19,"Please ensure that your image meets the following requirements:"),e.k0s(),e.j41(20,"p",15),e.EFF(21,"File size should be below 4 MB."),e.k0s(),e.j41(22,"p",15),e.EFF(23,"Accepted formats are JPG, PNG, and SVG."),e.k0s()()()(),e.j41(24,"div",16)(25,"h5"),e.EFF(26,"Information"),e.k0s()(),e.j41(27,"div",6)(28,"div",2)(29,"div",17)(30,"div",18)(31,"label",19),e.EFF(32,"First Name "),e.j41(33,"span",20),e.EFF(34,"*"),e.k0s()(),e.j41(35,"input",21),e.bIt("keypress",function(o){return i.preventWhitespace(o)}),e.k0s(),e.DNE(36,N,2,0,"div",22),e.k0s()(),e.j41(37,"div",17)(38,"div",18)(39,"label",23),e.EFF(40,"Last Name "),e.j41(41,"span",20),e.EFF(42,"*"),e.k0s()(),e.j41(43,"input",24),e.bIt("keypress",function(o){return i.preventWhitespace(o)}),e.k0s(),e.DNE(44,j,2,0,"div",22),e.k0s()(),e.j41(45,"div",17)(46,"div",18)(47,"label",25),e.EFF(48,"Date of Birth"),e.k0s(),e.j41(49,"p-calendar",26),e.bIt("ngModelChange",function(o){return i.onDateChange(o)})("onInput",function(o){return i.onDateChange(o)}),e.k0s()()(),e.j41(50,"div",27)(51,"div",18)(52,"label",28),e.EFF(53,"Phone Number "),e.j41(54,"span",20),e.EFF(55,"*"),e.k0s()(),e.j41(56,"input",29),e.bIt("keypress",function(o){return i.validateNumber(o)}),e.k0s(),e.DNE(57,I,2,0,"div",22),e.k0s()(),e.j41(58,"div",27)(59,"div",18)(60,"label",30),e.EFF(61,"Email Address "),e.j41(62,"span",20),e.EFF(63,"*"),e.k0s()(),e.j41(64,"input",31),e.bIt("keypress",function(o){return i.preventWhitespace(o)}),e.k0s(),e.DNE(65,E,3,2,"div",22),e.k0s()(),e.j41(66,"div",27)(67,"div",18)(68,"label",32),e.EFF(69,"Blood Group"),e.k0s(),e.j41(70,"select",33)(71,"option",34),e.EFF(72,"Select blood group"),e.k0s(),e.DNE(73,D,2,2,"option",35),e.k0s()()(),e.j41(74,"div",27)(75,"div",18)(76,"label",36),e.EFF(77,"Age"),e.k0s(),e.j41(78,"input",37),e.bIt("keypress",function(o){return i.validateNumber(o)}),e.k0s(),e.DNE(79,G,2,0,"div",22),e.k0s()()()(),e.j41(80,"div",16)(81,"h5"),e.EFF(82,"Address"),e.k0s()(),e.j41(83,"div",6)(84,"div",2)(85,"div",38)(86,"div",18)(87,"label",39),e.EFF(88,"Address"),e.k0s(),e.j41(89,"input",40),e.bIt("keypress",function(o){return i.preventWhitespace(o)}),e.k0s()()(),e.j41(90,"div",41)(91,"div",18)(92,"label",42),e.EFF(93,"City"),e.k0s(),e.j41(94,"input",43),e.bIt("keypress",function(o){return i.preventWhitespace(o)}),e.k0s()()(),e.j41(95,"div",41)(96,"div",18)(97,"label",44),e.EFF(98,"State"),e.k0s(),e.j41(99,"input",45),e.bIt("keypress",function(o){return i.preventWhitespace(o)}),e.k0s()()(),e.j41(100,"div",41)(101,"div",18)(102,"label",46),e.EFF(103,"Country"),e.k0s(),e.j41(104,"input",47),e.bIt("keypress",function(o){return i.preventWhitespace(o)}),e.k0s()()(),e.j41(105,"div",41)(106,"div",18)(107,"label",48),e.EFF(108,"Pincode"),e.k0s(),e.j41(109,"input",49),e.bIt("keypress",function(o){return i.validateNumber(o)})("input",function(o){return i.checkLength(o)}),e.k0s()()()()(),e.j41(110,"div",50)(111,"button",51),e.EFF(112,"Save Changes"),e.k0s()()()()()()()),2&l){let r,o,m,d,f;e.R7$(5),e.Y8G("formGroup",i.profileForm),e.R7$(4),e.Y8G("ngIf",i.selectedImageUrl),e.R7$(),e.Y8G("ngIf",!i.selectedImageUrl),e.R7$(26),e.Y8G("ngIf",(null==(r=i.profileForm.get("firstName"))?null:r.invalid)&&((null==(r=i.profileForm.get("firstName"))?null:r.dirty)||(null==(r=i.profileForm.get("firstName"))?null:r.touched))),e.R7$(8),e.Y8G("ngIf",(null==(o=i.profileForm.get("lastName"))?null:o.invalid)&&((null==(o=i.profileForm.get("lastName"))?null:o.dirty)||(null==(o=i.profileForm.get("lastName"))?null:o.touched))),e.R7$(5),e.Y8G("maxDate",i.maxDate),e.R7$(8),e.Y8G("ngIf",(null==(m=i.profileForm.get("phoneNumber"))?null:m.invalid)&&((null==(m=i.profileForm.get("phoneNumber"))?null:m.dirty)||(null==(m=i.profileForm.get("phoneNumber"))?null:m.touched))),e.R7$(8),e.Y8G("ngIf",(null==(d=i.profileForm.get("email"))?null:d.invalid)&&((null==(d=i.profileForm.get("email"))?null:d.dirty)||(null==(d=i.profileForm.get("email"))?null:d.touched))),e.R7$(8),e.Y8G("ngForOf",i.bloodGroups),e.R7$(6),e.Y8G("ngIf",(null==(f=i.profileForm.get("age"))?null:f.invalid)&&((null==(f=i.profileForm.get("age"))?null:f.dirty)||(null==(f=i.profileForm.get("age"))?null:f.touched))),e.R7$(32),e.Y8G("disabled",i.profileForm.invalid)}},dependencies:[u.Sq,u.bT,a.qT,a.xH,a.y7,a.me,a.wz,a.BC,a.cb,a.j4,a.JD,b.B,h.Vv],styles:[".profile-set[_ngcontent-%COMP%]{margin-top:70px}[_nghost-%COMP%]     span.p-calendar{width:100%}[_nghost-%COMP%]     p-element{display:block}[_nghost-%COMP%]     .p-inputtext{border-color:#e2e8f0;border-radius:6px;min-height:40px;padding:7px 15px}[_nghost-%COMP%]     .p-datepicker table td{padding:0}"]})}return n})()}];let B=(()=>{class n{static#e=this.\u0275fac=function(l){return new(l||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[c.iI.forChild(T),c.iI]})}return n})();var $=s(675);let O=(()=>{class n{static#e=this.\u0275fac=function(l){return new(l||n)};static#t=this.\u0275mod=e.$C({type:n});static#i=this.\u0275inj=e.G2t({imports:[u.MD,B,$.G,h.rO]})}return n})()}}]);